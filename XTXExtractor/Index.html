<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>XuetangX Discussion ID & Thread ID Extractor</title>
    <link href="./mui/css/mui.min.css" rel="stylesheet" type="text/css" />
    <link href="./style.css" rel="stylesheet" type="text/css" />
    <script src="./mui/js/mui.min.js"></script>
  </head>
 
  <body>
<!-- A Header -->
    <header class="mui-appbar mui--z1">
      <div class="mui-container">
        <table>
          <tr class="mui--appbar-height">
            <td class="mui--text-title">
              XuetangX Discussion ID & Thread ID Extractor
            </td>
          </tr>
        </table>
      </div>
    </header>

<!-- Scripts -->
  <script type="text/javascript">
  function GetID(){
    var mooclink = document.getElementById("weblinkbox").value;
    var didbox=document.getElementById("discussionid");
    var tidbox=document.getElementById("threadid");
    var regexDID = new RegExp(/(?<=forum\/).*(?=\/threads)/g);
    var regexTID = new RegExp(/(?<=threads\/).*/g);
    var didtext
    var tidtext
    while ((didtext = regexDID.exec(mooclink)) != null)  {
      didbox.value = (didtext);
      }
    while ((tidtext = regexTID.exec(mooclink)) != null)  {
      tidbox.value = (tidtext);
      }
  }

  function FcopyDID() {
    var DIDcopied=document.getElementById("discussionid");
    DIDcopied.select();
    document.execCommand('copy');
    alert("Discussion ID was successfully copied. Paste in Excel then click OK for next step.");
  }

  function FcopyTID() {
    var TIDcopied=document.getElementById("threadid");
    TIDcopied.select();
    document.execCommand('copy');
    alert("Thread ID was successfully copied. Paste in Excel then click OK for next step.");
  }

  function copyBKMKlet() {
    var bookmarkbox=document.getElementById("bookmarklink");
    bookmarkbox.select();
    document.execCommand('copy');
    alert("Copy Succeed!");
  }
  </script>

<!-- Contents -->
  <div id="content-wrapper" class="mui-container">
      <div class="mui--appbar-height"></div>
      <br>
      <ul class="mui-tabs__bar">
        <li class="mui--is-active"><a data-mui-toggle="tab" data-mui-controls="regular-panel">Rugular</a></li>
        <li><a data-mui-toggle="tab" data-mui-controls="oneclick-panel">UMx One-Click</a></li>
      </ul>
    <div class="mui-tabs__pane mui--is-active" id="regular-panel">

      <div class="mui-panel">
        <div class="mui-textfield">
          <input type="text" id="weblinkbox" placeholder="Paste the Thread URL Here!">
          <br>
          <center><button type="submit" onclick="GetID()" class="mui-btn mui-btn--raised mui-btn--primary">Get Started!</button></center>
        </div>
      </div>
      
      <div class="mui-textfield">
        <b>Discussion ID: </b>
          <input type="text" id="discussionid" readonly = "readonly">
          <div align="right"><button type="submit" onclick="FcopyDID()" class="mui-btn mui-btn--flat mui-btn--primary">Copy Discussion ID</button></div>
      </div>

      <div class="mui-textfield">
        <b>Thread ID: </b>
          <input type="text" id="threadid" readonly = "readonly">
          <div align="right"><button type="submit" onclick="FcopyTID()" class="mui-btn mui-btn--flat mui-btn--primary">Copy Thread ID</button></div>
      </div>
      <div class="mui-textfield">
        <b>User ID: </b>
          <input type="text" id="userid" readonly = "readonly" placeholder="Experimental">
          <div align="right"><button type="submit" onclick="FcopyUID()" class="mui-btn mui-btn--flat mui-btn--primary">Copy User ID</button></div>
      </div>      
      <br>
      <br>
      <img src="V1.jpg" width=100%">
      <br>
      <br>
    </div>
    <div class="mui-tabs__pane" id="oneclick-panel">
        <br>
        <div class="mui--text-headline">Introduting UMx One-Click</div>   
        <br>  
        <div>
          <p>UMx One-Click is a Bookmarklet extracting and copying "User ID", "Discussion ID" and â€œThread ID" to the clipboard from XuetangX forum pages. </p>
          <div class="mui-panel">
              <div class="mui-textfield">
                <textarea rows="1" style="resize:none" id="bookmarklink" readonly>javascript:var getuid1=document.getElementsByClassName("post-header-content")[0], getuid2=getuid1.getElementsByClassName("posted-details")[0], useridlink=getuid2.getElementsByClassName("username")[0];!function(a){var b=document.createElement("textarea"),c=document.getSelection();b.textContent=a,document.body.appendChild(b),c.removeAllRanges(),b.select(),document.execCommand("copy"),c.removeAllRanges(),document.body.removeChild(b)}(new RegExp(/(?<=users\/).*/g).exec(useridlink));alert("User ID was successfully copied!");!function(a){var b=document.createElement("textarea"),c=document.getSelection();b.textContent=a,document.body.appendChild(b),c.removeAllRanges(),b.select(),document.execCommand("copy"),c.removeAllRanges(),document.body.removeChild(b)}(new RegExp(/(?<=forum\/).*(?=\/threads)/g).exec(window.location.href));alert("Discussion ID was successfully copied, click OK to continue!");!function(a){var b=document.createElement("textarea"),c=document.getSelection();b.textContent=a,document.body.appendChild(b),c.removeAllRanges(),b.select(),document.execCommand("copy"),c.removeAllRanges(),document.body.removeChild(b)}(new RegExp(/(?<=threads\/).*/g).exec(window.location.href));alert("Thread ID was successfully copied, click OK to continue!");</textarea>
                <br>
                <div align="right"><button type="submit" onclick="copyBKMKlet()" class="mui-btn mui-btn--flat mui-btn--primary">Copy to Clipboard</button></div>
              </div>
            </div>
          <p>To use this script, click "COPY TO CLIPBOARD" first, press Ctrl / Command + D and paste the script in bookmark editor of your browser. Don't forget rename the bookmark as "UMx One-Click" or any other you like.</p>
          <p>Notes: <br>
            1. A latest version of Google Chrome is needed for this script. <br>
            2. I developed and tested this script with / on Google Chrome, everything goes smoothly. <br>
            3. Apple Safari and mobile devices are NOT supported. <br>
          </p>
          <details>
              <summary>Demo: Seeing is believing. (Click Here)</summary>
              <p><img src="UMx1ClickAnimation.webp" width="100%"></p>
          </details>
          <br>
          <div align="center"><img src="UMx1Click.png" width="80%"></div>
          <br>
          </div>
  </div>
</div>

<!-- A Footer -->
    <footer>
      <div class="mui-container mui--text-center">
        Version 1.1, CSS framework by <a href="https://www.muicss.com/">MUI</a>
        <br>
        R. K. Amamiya@UMx Team; Special Thanks: <a href="https://github.com/Mion354D">Kirisame Mion</a>
      </div>
    </footer>

  </body>
</html>